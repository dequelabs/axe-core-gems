version: 2.1

defaults: &defaults
  docker:
    - image: circleci/ruby:2.4.3-node-browsers
  working_directory: ~/axe-core-gems

commands:
  install-bundler: 
    description: Install bundler
    parameters:
      version:
        type: string
        default: "2.1"
    steps:
      - run: |
          echo export BUNDLER_VERSION=<< parameters.version >> >> $BASH_ENV
          source $BASH_ENV
          gem install bundler

jobs:
  test: 
    <<: *defaults
    steps:
      - checkout
      - install-bundler
      - run: |
          rake bootstrap
          rake test

workflows:
  version: 2
  build:
    jobs:
      - test