version: 2

defaults: &defaults
  docker:
    - image: circleci/ruby:2.4.3-node-browsers
  working_directory: ~/axe-core-gems

commands:
  configure_bundler: 
    description: Configure Bundler
    steps:
      - run: |
          echo export BUNDLER_VERSION=2.1 >> $BASH_ENV
          source $BASH_ENV
          gem install bundler

jobs:
  test: 
    <<: *defaults
    steps:
      - checkout
      - configure_bundler
      - run: |
          rake bootstrap
          rake test

workflows:
  version: 2
  build:
    jobs:
      - test